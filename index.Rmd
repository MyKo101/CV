---
title: "Michael Barrowman"
output:
  html_document:
    includes:
      in_header: "header.html" 
    css: style.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(kableExtra)
library(lubridate)
library(magrittr)
library(glue)
library(png)
```

```{r functions, include=F}
get_format <- function(x=NULL)
{
  if(knitr:::is_latex_output())
    cFormat <- "latex" else 
      cFormat <- "html"
    
  if(!is.null(x))
  {
    return(cFormat == x)
  } else {
    return(cFormat)
  }
}

format_choice <- function(.latex,.html)
{
  if(get_format("html"))
    return(.html)
  
  if(get_format("latex"))
    return(.latex)
}

 
    
  


```

::::{style="display: grid; grid-template-columns: 1fr 2fr; grid-column-gap: 20px;"}

:::{}

```{r profile,echo=F}
knitr::include_graphics("img/ProfileRaw.jpg")
```



```{r contact, echo=F}
read_csv("data/Contact.csv",col_types=cols()) %>%
  mutate(logo=paste0("<img src=\"img/",medium,"-logo.png\" width=\"20px\" />",
                     "<a href=\"",link,"\">",
                     contact,
                     "</a>",
                     "</img>")) %>%
  select(logo) %>%
  kable(col.names="",escape=F)

```



:::

:::{}

# {.tabset}

## Bio

I am currently studying towards a PhD in Medicine with a focus on statistics from both an applied and methodological perspective, whilst working as a Maths and Stats Tutor. I have experience in the public and private sector, dealing primarily with medical and education data, and can provide in-depth outputs and precise insights to a wide range of audiences. I am quick to learn new systems, processes or data structures and can breakdown complicated ideas in a simple and understandable way. I am experienced in tutoring and teaching at most levels of education, primarily focusing on mathematics and statistics. I am accomplished in a multitude of professional software and programming languages including R with RMarkdown, LaTeX, SPSS, nVivo, SAS, Stata, Python, SQL, Excel (w/VBA), Google Sheets (w/ Script).


## Experience



I have worked in a variety of roles in both the public and private sector, covering two primary fields: Education and Data Analysis. Several of my roles have incorporated both of these facets.

```{r, echo=F}
Exp_tbl <- read_csv("data/Experience.csv",col_types = cols()) %>%
  mutate(Start = dmy(paste0("01 ",Start),quiet=T),
         End = dmy(paste0("01",End),quiet=T)) %>%
  arrange(!is.na(End),desc(Start)) %>%
  mutate(Employer = fct_inorder(Employer)) %>%
  arrange(Employer,!is.na(End),desc(End)) %>%
  mutate(Start = format(Start,"%b '%y"),
         End = format(End,"%b '%y"),
         End = replace_na("Present"))

Exp_Template <- format_choice(
  "*{`Job Title`}*, _{Start} - {End}_\\newline{Description}",
  "*{`Job Title`}*, _{Start} - {End}_<br>{Description}"
)


grp_index <- auto_index(as.character(Exp_tbl$Employer))
Exp_tbl %<>% select(-Employer)

Exp_tbl %>% 
  transmute(ss = paste0(str_glue_data(.,Exp_Template))) %>%
  kable(format=get_format,escape=F,col.names=NULL) %>%
  kable_styling(bootstrap_options = "basic") %>%
  pack_rows(index=grp_index)
```

:::
::::